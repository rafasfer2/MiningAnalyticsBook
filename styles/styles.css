/* ==============================================================================
   ESTRUTURA FINAL DO LAYOUT (V10.8 - TOC FIXED & NÍVEL 3 FORÇADO)
   ============================================================================== */

/* --- 1. VARIÁVEIS E CORES GLOBAIS --- */
:root {
  /* 1.1. Paleta Customizada (Completa - BrBG) */
  --color-brown-dark:   #543005;
  --color-brown-med:    #8c510a;
  --color-brown:        #bf812d;
  --color-brown-light:  #dfc27d;
  --color-cream:        #f6e8c3;
  --color-cyan-light:   #c7eae5;
  --color-cyan-mid:     #80cdc1;
  --color-teal:         #35978f;
  --color-teal-dark:    #01665e;
  --color-teal-deep:    #003c30;

  /* 1.2. ESCALAS DE DESTAQUE E SUPORTE */
  --color-gold:         #d4af37;
  --color-gold-base:    #ffd700;
  --color-gold-darker:  #b39700;
  --color-gray-soft:    #CCCCCC;
  --color-hover-gray:   #e3e3e3;
  --color-gray-med:     #aaaaaa;

  /* 1.3. Layout Dimensions */
  --sidebar-width:      320px;
  --toc-width:          320px;
  --header-height:      60px;

  --content-gap:        -11rem;
  --text-padding-left:  0.75rem;
}

/* === COMPONENTES ISOLADOS === */
.exemplo-book {
  background-color: #e6f9e6;
  border-left: 4px solid #4CAF50;
  padding: 1em;
  margin: 1em 0;
  font-weight: bold;
  font-style: italic;
}

/* =========================================
   2. RESET GERAL E TIPOGRAFIA BASE
   ========================================= */
body, html {
  margin: 0 !important;
  padding: 0 !important;
  overflow-x: hidden; /* Nota: Isso impede o sticky de funcionar, por isso usaremos FIXED no TOC */
  font-family: 'Roboto', 'Segoe UI', Arial, sans-serif;
  font-size: 12pt;
  line-height: 1.5;
  text-rendering: optimizeLegibility;
}

h1, h2, h3 {
  color: var(--color-brown-dark);
  font-family: 'Roboto', 'Segoe UI', Arial, sans-serif;
}
h1 { border-bottom: 2px solid var(--color-brown); }
h2 { color: var(--color-brown-med); }

main.content p, main.content blockquote { text-align: justify; }

/* =========================================
   3. SIDEBAR (ESQUERDA)
   ========================================= */
#quarto-sidebar {
  position: fixed !important;
  left: 0 !important; top: 0 !important;
  width: var(--sidebar-width) !important;
  height: 100vh !important;
  z-index: 100; padding: 0 !important; margin: 0 !important;
  background: var(--color-teal-dark) !important;
}

#quarto-sidebar .sidebar-title {
  color: white !important;
  font-weight: 700;
  padding: 1.2rem 1rem !important;
  border-bottom: 2px solid var(--color-teal) !important;
}

#quarto-sidebar .sidebar-item,
#quarto-sidebar .sidebar-item-container {
    margin: 0 !important;
    padding: 0 !important;
}

#quarto-sidebar .sidebar-item-text {
  display: flex !important;
  align-items: center !important;
  white-space: normal;
  overflow: hidden;
  padding: 0.2rem 1rem 0.2rem var(--text-padding-left) !important;
  margin: 0 !important;
  color: white !important;
  font-size: 0.8rem !important;
  border-left: 4px solid transparent !important;
}

#quarto-sidebar .chapter-number { color: white !important; }

#quarto-sidebar .sidebar-item-text.active {
  background: rgba(255, 255, 255, 0.15) !important;
  color: var(--color-gold-base) !important;
  border-left: 4px solid var(--color-gold-base) !important;
  font-weight: bold !important;
}

/* =========================================
   4. CONTEÚDO PRINCIPAL (LAYOUT)
   ========================================= */
#quarto-header {
  position: fixed !important; top: 0 !important;
  left: var(--sidebar-width) !important;
  right: var(--toc-width) !important;
  height: var(--header-height) !important;
  background: white !important;
  z-index: 99 !important;
}

body.nav-sidebar {
  padding-left: calc(var(--sidebar-width) + var(--content-gap)) !important;
  padding-right: calc(var(--toc-width) + var(--content-gap)) !important;
  padding-top: var(--header-height) !important;
  margin: 0 !important;
}

main.content h1, main.content h2, main.content p, main.content ul, main.content ol, main.content blockquote {
  padding-left: var(--text-padding-left) !important;
  padding-right: var(--text-padding-left) !important;
  margin: 0 0 1rem 0 !important;
}

/* --- Ajustes detalhados para listas --- */
main.content ul, main.content ol {
  padding-left: 0 !important;
  list-style-position: outside !important;
}
main.content ul { margin-left: 2rem !important; }
main.content ol {
  margin-left: 1.6rem !important;
  padding-left: 1.6rem !important;
}
main.content ul li, main.content ol li {
  margin-bottom: 0.6rem !important;
}

/* =========================================
   5. TABLE OF CONTENTS (DIREITA) - CORREÇÃO DE LINHA DUPLICADA
   ========================================= */

/* 5.1. Container e Fixação */
#quarto-margin-sidebar {
  position: fixed !important;
  top: var(--header-height) !important;
  right: 0 !important;
  width: var(--toc-width) !important;
  height: calc(100vh - var(--header-height)) !important;
  overflow-y: auto !important;
  z-index: 90 !important;
  padding-left: 1rem;
  background-color: white;
}

#quarto-toc-target {
  display: block !important;
  padding-top: 1.5rem;
}

/* Título do Índice */
#quarto-toc-target h2 {
  font-size: 0.85rem;
  font-weight: normal;
  text-transform: none;
  color: #495057;
  border-bottom: none;
  margin-bottom: 1rem;
}

/* 5.2. Estrutura da Trilha (Linha Única) */
/* Aplicamos a borda apenas no UL raiz */
nav[role="doc-toc"] > ul {
  list-style: none;
  border-left: 1px solid #dee2e6 !important; /* Linha cinza de fundo */
  padding-left: 0 !important;
  margin-left: 0.5rem !important;
}

/* REMOÇÃO DA LINHA DUPLICADA:
   Desativa bordas em todos os níveis internos e containers de itens */
nav[role="doc-toc"] ul ul,
nav[role="doc-toc"] ul ul ul,
nav[role="doc-toc"] li {
  border-left: none !important;
  margin-bottom: 0 !important;
}

/* Garante que o nível 3 apareça sem criar novas linhas */
nav[role="doc-toc"] ul > li > ul > li > ul {
  display: block !important;
  visibility: visible !important;
  height: auto !important;
}

/* 5.3. Links e Identação */
nav[role="doc-toc"] a.nav-link {
  display: block;
  font-size: 0.8rem !important;
  line-height: 1.2 !important;
  padding: 0.25rem 0 0.25rem 1rem !important;
  color: var(--color-brown-med) !important;
  text-decoration: none;
  margin-left: -1px; /* Alinha a borda ativa sobre a cinza */
  border-left: 2px solid transparent !important;
}

/* Recuo do texto sem mover a linha */
nav[role="doc-toc"] ul ul a.nav-link { padding-left: 1.8rem !important; }
nav[role="doc-toc"] ul ul ul a.nav-link { padding-left: 2.8rem !important; }

/* 5.4. Item Ativo (Destaque na Trilha) */
nav[role="doc-toc"] a.nav-link.active {
  color: #637238 !important; /* Cor oliva conforme imagem */
  font-weight: 700 !important;
  border-left: 2px solid #637238 !important; /* Barra de destaque */
}

/* =========================================
   6. ELEMENTOS ESPECÍFICOS (FIGURES & CITATIONS)
   ========================================= */
.quarto-float-caption,
.quarto-figure .quarto-float-caption,
.quarto-figure .quarto-float-caption-bottom {
  margin-left: var(--text-padding-left) !important;
  padding-left: 0 !important;
  text-align: left !important;
  max-width: calc(100% - var(--text-padding-left)) !important;
}

.citation-superscript,
a.citation sup.citation-superscript,
span.citation sup.citation-superscript {
  font-size: 0.85em;
  line-height: 1;
  vertical-align: super;
}

/* =========================================
   7. BLOCOS DE CÓDIGO E SAÍDA (R)
   ========================================= */
.cell pre.sourceCode {
  background-color: #fdfdfd !important;
  border: 1px solid var(--color-gray-soft) !important;
  border-bottom: none !important;
  border-radius: 4px 4px 0 0 !important;
  margin-bottom: 0 !important;
}

.cell-output-stdout, .cell-output-display {
  background-color: #f4f4f4 !important;
  border: 1px solid var(--color-gray-soft) !important;
  border-top: 1px solid var(--color-hover-gray) !important;
  border-left: 4px solid var(--color-teal) !important;
  border-radius: 0 0 4px 4px !important;
  padding: 0.85rem 1rem !important;
  margin-top: 0 !important;
  font-family: 'Fira Code', 'Courier New', monospace !important;
  font-size: 0.85rem !important;
}

.cell-output-stdout + .cell-output-stdout,
.cell-output-display + .cell-output-display {
  margin-top: -1px !important;
  border-top: none !important;
  border-radius: 0 !important;
}

/* =========================================
   8. RESPONSIVIDADE
   ========================================= */
@media (max-width: 900px) {
  main.content ul, main.content ol {
    margin-left: 1rem !important;
    padding-left: 0.5rem !important;
  }
  .quarto-float-caption, .quarto-figure .quarto-float-caption {
    margin-left: var(--text-padding-left) !important;
    max-width: calc(100% - var(--text-padding-left)) !important;
  }
  body.nav-sidebar {
    padding-left: 0 !important;
    padding-right: 0 !important;
  }
}

/* =========================================
   9. CUSTOMIZAÇÃO DO BREADCRUMB (CABEÇALHO)
   ========================================= */

.quarto-breadcrumb,
.breadcrumb {
  font-size: 1.0rem !important;
  font-weight: 400;

  /* Alinhamento com a margem do conteúdo principal */
  margin-left: var(--content-gap) !important;
  padding-left: var(--text-padding-left) !important;

  margin-top: 5px !important;
  margin-bottom: 0 !important;
}

/* Cores dos links (Teal) */
.breadcrumb-item,
.breadcrumb-item a {
  color: var(--color-teal) !important;
  text-decoration: none;
}

/* Separador ">" */
.breadcrumb-item + .breadcrumb-item::before {
  color: var(--color-gray-med) !important;
  padding: 0 0.5rem;
}

/* Remove recuo do container pai para garantir o alinhamento */
#quarto-header .navbar-container {
  padding-left: 0 !important;
}
