---
format: html
---

# Excelência Operacional e Metrologia de Performance {#chap-kpi}

```{r setup, include=FALSE}
#| message: false
#| warning: false
# Preparação do ambiente com as bibliotecas fundamentais para mineração e análise de dados
library(tidyverse)
library(miningKPI)
library(knitr)
library(fpp3)
library(lubridate)
library(kableExtra)
```

A mineração contemporânea opera em um cenário de complexidade crescente, onde a volatilidade das commodities e a exaustão de reservas de alto teor exigem uma precisão cirúrgica na gestão de ativos. Nesse contexto, a Excelência Operacional não é apenas um objetivo aspiracional, mas uma disciplina rigorosa fundamentada na capacidade de converter dados brutos em decisões estratégicas em tempo real.

Este capítulo estrutura os indicadores fundamentais que compõem a espinha dorsal do sistema de gestão, organizados por níveis hierárquicos e função dentro do SGI.

## Metrologia de Performance e Identidade Fundamental

### Elementos de Suporte e Categorização de Horas

Os elementos de suporte são os dados diretamente monitorados e coletados durante a produção. No ciclo de processos de transporte, os dados coletados dos equipamentos são denominados tempos operacionais.

A classificação das horas é dividida hierarquicamente para facilitar a gestão, permitindo o desdobramento desde a disponibilidade global até a causa raiz do evento. Esta estrutura é o fundamento para o processamento de telemetria e o cálculo de KPIs no pacote `miningKPI`.

**HC – Horas Calendário (Calendar Hours - CH)**[^performance-kpi-1]: Tempo total de existência do ativo no período $(p)$ 24h/dia, 7 dias/semana, resultando em\
$365 \times 24 = 8760\ h/ano$ (ou $8784$ h em anos bissextos). $$HC_{p} = HT_{p} + HO_{p} + HM_{p}$$ onde:

[^performance-kpi-1]: A hora calendário de um equipamento novo inicia-se quando for realizada a entrega técnica à operação e termina quando é feita a baixa definitiva do equipamento pela manutenção.Para um determinado período $p$ considerado, tem-se que:

-   **HT – Horas Trabalhadas (Worked Hours – WH):** ($HT = HTP + HTNP$)

    -   **HTP – Horas Trabalhadas Produtivas (Productive Worked Hours – PWH):** ($HTP = HEF + HAO$)

        -   **HEF – Horas Efetivas (Effective Hours – EFH):** Tempo em que o equipamento desenvolve trabalho útil na função primária (ex: contato bit-rocha na perfuração).

        -   **HAO – Horas de Atraso Operacional (Operational Delay Hours – ODH):** Atrasos inerentes ao ciclo perfeito, como esperas por caminhão, manobras de sinalização ou filas curtas.

    -   **HNTP – Horas Trabalhadas Não Produtivas (Non-Productive Worked Hours – NPWH):** ($HTNP = HTI + HTD$)

        -   **HTI – Horas de Infraestrutura (Infrastructure Worked Hours – IWH):** Atividades de suporte à fase produtiva, como acerto de praça ou manutenção de acessos.

        -   **HTD – Horas Trabalhadas Diversas (Different Worked Hours – DWH):** Trabalho fora do ciclo operacional principal, como locomoções curtas para abastecimento ou apoio a outros processos.

-   **HO – Horas Ociosas (Idle Hours – IH):** ($HO = HOI + HOE$)

    -   **HOI – Horas Ociosas Internas (Internal Idle Hours – IIH):** Equipamento apto, mas parado por falta de recursos internos (ex: operador, troca de turno, aguardando projeto ou topografia).

    -   **HOE – Horas Ociosas Externas (External Idle Hours – EIH):** Equipamento apto, mas parado por fatores externos não gerenciáveis pela unidade (ex: clima adverso, raios ou falta de energia da rede).

**HM – Horas em Manutenção (Maintenance Hours):** ($HM = HTMCT + HMP$)

-   **HMCT – Horas de Manutenção Corretiva Total (Total Corrective Maintenance Hours – TCMH):** ($HMCT = HMC + HAC$)

    -   **HMC – Horas de Manutenção Corretiva (Corrective Maintenance Hours – CMH):** Tempo de indisponibilidade para intervenção corretiva não planejada visando restaurar a função após uma falha.

    -   **HAC – Horas de Acidente (Accident Hours – ACH):** Tempo sob responsabilidade da manutenção em decorrência de acidentes ou danos causados por fatores externos.

-   **HMP – Horas de Manutenção Preventiva (Preventive Maintenance Hours – PMH):** ($HMP = MPS + MPNS$)

    -   **MPS – Manutenção Preventiva Sistemática (Systematic Preventive Hours – SPH):** Manutenções planejadas repetidas em intervalos definidos (horas, km ou data), sem indicação prévia de defeito.

    -   **MPNS – Manutenção Preventiva Não Sistemática (Non-Systematic Programmed Hours – NSPH):** Intervenções baseadas em monitoramento de condição (preditiva) ou programadas fora de ciclos sistemáticos rígidos.

#### Nota sobre Nomenclatura e Siglas Internacionais

Para garantir a compatibilidade com os sistemas de telemetria globais e o uso do pacote `miningKPI`, este livro adota uma abordagem bilíngue nas siglas. Enquanto as definições teóricas seguem o padrão da gestão de mineração em português, os algoritmos e conjuntos de dados utilizam a nomenclatura técnica internacional (Inglês).

A tabela abaixo estabelece a correlação direta entre as siglas utilizadas no corpo do texto e as variáveis que o leitor encontrará nos blocos de código:

|                               |                      |                        |
|----------------------------|---------------------|-----------------------|
| **Descrição (PT-BR)**         | **Sigla Livro (PT)** | **Sigla Técnica (EN)** |
| Horas Efetivas                | **HEF**              | **EFH**                |
| Horas de Atraso Operacional   | **HAO**              | **ODH**                |
| Horas de Infraestrutura       | **HTI**              | **IWH**                |
| Horas Trabalhadas Diversas    | **HTD**              | **DWH**                |
| Horas Paradas Operacionais    | **HPO**              | **SOH**                |
| Horas de Manutenção Corretiva | **HMC**              | **CMH**                |
| Manutenção Prev. Sistemática  | **MPS**              | **SPH**                |
| Horas Ociosas Internas        | **HOI**              | **IIH**                |
| Horas Ociosas Externas        | **HOE**              | **EIH**                |

#### Categorias de Estado e Mensuração

As categorias de **Horas Trabalhadas (HT)**, **Horas em Manutenção (HM)** e **Horas Ociosas (HO)** representam o destino primário de cada evento de telemetria. Elas são mutuamente exclusivas e compõem a base do processamento de dados.

#### Indicadores de Fluxo e Interface Operacional

Diferente das categorias de estado, as **HD** e **HPO** possuem um tratamento metrológico distinto, pois atuam como elos de ligação entre a capacidade entregue pela manutenção e o aproveitamento real pela operação.

##### HD – Horas Disponíveis (Available Hours — AH)

A **HD** não é um apontamento direto, mas sim o volume absoluto de tempo em que o ativo está tecnicamente apto para o uso. Ela representa o elo fundamental entre a manutenção e a operação: a manutenção "entrega" Horas Disponíveis, e a operação as "consome".

$$HD_{p} = HC_{p} - HM_{p}$$

Nesta lógica, a **HD** é o balizador da confiabilidade técnica. Se a manutenção reduz o $HM$, o "estoque" de horas para a operação ($HD$) aumenta automaticamente.

##### HPO – Horas Paradas Operacionais (Stopped Hours Operations — SOH)

A **HPO** é tratada de forma segregada por representar paradas que impactam a produção, mas que não possuem origem em falhas mecânicas ou falta de demanda (ociosidade). No SGI, o registro de **HPO** é vital para não "contaminar" os indicadores de manutenção com ineficiências de fluxo da mina.

> Nota para o Leitor:
>
> Enquanto as demais horas são classificadas por estado físico do ativo, a HD é uma categoria de capacidade e a HPO é uma categoria de perda de processo. No pacote miningKPI, a HPO (sigla técnica SOH) deve ser monitorada rigorosamente para identificar gargalos de infraestrutura que a Utilização Física (UF) muitas vezes mascara.

::: {#exm-processamento-categorias}
**Processamento de Categorias de Horas**

Como a medição é feita baseado em durações de tempo, os apontamentos são realizados sempre que um determinado equipamento alterar o seu status de operação. Para análise de categoria de horas, utiliza-se o `gap_time` que é a duração (em horas) do início e fim do evento.
:::

```{r}
#| label: tbl-consolidacao-horas
#| echo: true
#| message: false

# Cálculo de durações (gap_time) utilizando intervalos (%--%)
df_exm1 <- drill_events_mine_d %>%
  select(drill_id, category, first_time, exit_time) %>%
  mutate(
    gap_time = (first_time %--% exit_time) / dhours(1), # Calcula a diferença dos tempos em horas decimais
    day = as_date(first_time)                           # Normalizando data para agrupamento por período (p = 1 dia)
  ) %>%
  filter(drill_id == "DRILL_100", day >= "2023-01-01") %>%
  print(n = 10) # Observe que as categorias se alternam ao longo do dia

# Consolidação por categoria
resumo_kpi <- df_exm1 %>%
  filter(day == "2023-01-01") %>%
  group_by(day, drill_id, category) %>%
  summarise(
    gap_time = sum(gap_time),
    n_events = n(),
    .groups = "drop"
  )

# Adição da linha de totais e renderização da tabela
resumo_kpi %>%
  bind_rows(summarise(resumo_kpi , across(where(is.numeric), sum), drill_id = "TOTAL")) %>%

  kable(
    digits = 2,
    align = "c",
    col.names = c("Data (p)", "Equipamento (TAG)", "Categoria", "Tempo (h)", "Eventos (n)")
  ) %>%
  kable_styling(bootstrap_options = "striped", full_width = TRUE) %>%
  # Cabeçalho Teal
  row_spec(0, background = "#35978f", color = "white", bold = TRUE) %>%
  # Destaque das colunas de métricas (Verde)
  column_spec(4:5, bold = TRUE, background = "#e0f2f1", color = "#01665e") %>%
  # Linha de Totais: Fundo amarelo, texto preto (sobrescreve o verde) e borda inferior
  row_spec(
    nrow(resumo_kpi) + 1,
    bold = TRUE,
    background = "#fff9c4",
    color = "black",
    extra_css = "border-bottom: 1.0pt solid black;"
  )
```

A análise dos dados consolidados para a perfuratriz **DRILL_100** permite um diagnóstico preciso da saúde operacional do ativo, transformando a telemetria bruta em informações acionáveis para a gestão de PCO (Planejamento e Controle Operacional).

#### Validação da Identidade Fundamental e Integridade do Dado

O primeiro passo da auditoria metrológica consiste em observar a linha de **TOTAL**. O valor de **24,0h** confirma que a soma de todas as categorias de tempo preenche exatamente o período diário, validando a integridade das **Horas Calendário (CH)**. Não há "gaps" ou sobreposições de eventos. O somatório de **94 eventos** indica uma alta frequência de mudanças de estado, sugerindo uma operação dinâmica que exige monitoramento constante da variabilidade.

#### Eficiência Operacional e Ritmo de Trabalho

As **Horas Efetivas (EFH)** totalizaram **11,3h**, o que representa menos de 50% do tempo total disponível no dia para trabalho útil (contato bit-rocha). Complementarmente, as **Horas de Atraso Operacional (ODH)** somaram **3,30h**, porém distribuídas em **40 eventos** distintos. Esta fragmentação revela uma "fricção" logística: o ativo sofre microparadas constantes que, embora curtas individualmente, degradam significativamente o tempo produtivo acumulado.

#### Diagnóstico de Perdas Gerenciais (IIH)

Um ponto crítico identificado é o volume de **Horas Ociosas Internas (IIH)**, que somou **5,44h**. É relevante notar que a perda por ociosidade gerencial (falha de recursos internos como operador ou frente de lavra) foi superior ao tempo gasto com manutenção corretiva. Para o gestor, este dado indica que a eficiência da **gestão operacional** foi o principal gargalo do dia, e não a confiabilidade mecânica do equipamento.

#### Disponibilidade Técnica e Confiabilidade

As **Horas de Manutenção Corretiva (CMH)** registraram **3,96h** em um **único evento**. Isso indica uma falha funcional pontual que manteve o ativo indisponível por um bloco contínuo de tempo. Embora tenha impactado a disponibilidade física, a ocorrência de apenas uma intervenção sugere que, após o reparo, o ativo manteve sua estabilidade técnica ao longo das demais horas operadas.

**Resumo para o Leitor:**

> "A tabela demonstra que a DRILL_100 é um ativo tecnicamente confiável (baixa incidência de falhas), mas subutilizado pela operação. O volume excessivo de IIH e a fragmentação em 40 eventos de ODH revelam que o principal gargalo de produtividade está no fluxo logístico e de gestão da mina, superando o impacto das paradas de manutenção neste período."

### Do Processamento de Eventos à Consolidação por Período

Vimos no @exm-processamento-categorias que para cada categoria de horas, tem-se $n >=1$ eventos que podem ocorrer para um mesmo período. Logo, a transição da telemetria bruta para a análise gerencial exige a agregação por período ($p$). Se em um período ($p=1$ dia) o sistema registrou $n$ eventos de perfuração, a disponibilidade efetiva diária é o somatório de cada duração individual $i$:

$$EFH_{p} = \sum_{i=1}^{n} EFH_i$$

{#eq-efh-soma}

Ao contarmos o número de eventos para o dia 01/01, identificamos 32 registros. Portanto, a disponibilidade consolidada é a soma dessas 32 parcelas discretas, onde cada $i$ representa a ordem cronológica do evento no dia:

$$EFH_{p=1} = \sum_{i=1}^{32} EFH_i = EFH_1 + EFH_2 + ... + EFH_{32} = 11.30h$$

O código abaixo comprova essa identidade aritmética, exibindo os eventos individuais que compõem o total:

```{r}
#| label: tbl-consolidacao-gerencial
#| echo: true

# Consolidação dos tempos por categoria e pivotagem para visão gerencial
resumo_gerencial <- df_exm1 %>%
  group_by(day, drill_id, category) %>%
  summarise(gap_time = sum(gap_time), .groups = "drop") %>%
  # Transforma as categorias em colunas (formato wide)
  pivot_wider(names_from = category, values_from = gap_time, values_fill = 0) %>%
  # Inclusão manual de categorias com valor zero para fins didáticos:
  # O leitor deve notar que, mesmo sem eventos registados no log, a estrutura do SGI
  # é mantida para garantir que o mapa completo de horas seja visível na análise.
  mutate(IWH = 0, DWH = 0, ACH = 0, SPH = 0) %>%
  # Reorganização e criação da coluna CH (Calendar Hours) para auditoria metrológica
  select(day, drill_id, EFH, ODH, IWH, DWH, IIH, EIH, CMH, ACH, SPH, NSPH) %>%
  mutate(CH = rowSums(across(where(is.numeric))))

# Criamos um objeto para o recorte para garantir que o row_spec encontre o índice correto
df_display <- resumo_gerencial %>%
  slice_head(n = 10)

df_display %>%
  kable(
    digits = 2,
    align = "c",
    # Padronização de colunas do livro
    col.names = c("Data (p)", "Equipamento (TAG)", "EFH", "ODH", "IWH", "DWH", "IIH", "EIH", "CMH", "ACH", "SPH", "NSPH", "CH")
  ) %>%
  kable_styling(bootstrap_options = c("striped", "condensed"), full_width = TRUE, font_size = 11) %>%
  # Cabeçalho Teal Palette
  row_spec(0, background = "#35978f", color = "white", bold = TRUE) %>%
  # Destaque na coluna de validação CH (Auditoria Metrológica)
  column_spec(13, bold = TRUE, background = "#e0f2f1", color = "#01665e") %>%
  # Linha final ajustada para o tamanho do recorte (10 linhas)
  row_spec(
    nrow(df_display),
    extra_css = "border-bottom: 1.5pt solid black;"
  )
```

## Reconciliação Metrológica

Como demonstrado na @tbl-drill-down-efh-index, a presença do índice $i$ permite que o gestor de **PCO** realize a trilha de auditoria de cada fragmento produtivo. Esta abordagem elimina a "caixa-preta" das médias globais e expõe a variabilidade inerente do processo. Se o evento $i=1$ dura 0.71h e o evento $i=2$ dura apenas 0.11h, a análise de causa raiz deve buscar nos dados de telemetria complementares (como dureza da rocha ou habilidade do operador) o motivo de tal dispersão.

### DF — Disponibilidade Física (Physical Availability — PA)

Mensura a prontidão técnica do ativo para operação, independentemente de haver demanda ou restrição de mercado.

$$\mathrm{DF}_p = \frac{HC_{p} - HM_{p}}{HC_{p}} \times 100 = \frac{HD_{p}}{HC_{p}} \times 100$$ {#eq-df} onde $HM_{p}=(HMC + HAC + MPS + MPNS)_{p}$ é somatório de todos os eventos relacionados à manutenção.

### UF — Utilização Física (Physical Utilization — PU)

Avalia a eficiência da operação em ocupar as janelas de disponibilidade técnica ($HD_p$).

$$\mathrm{UF}_p = \frac{HT_{p}}{HD_{p}} \times 100$$ {#eq-uf}

onde $HT_{p}=(HEF + HAO + HTI + HTD)_{p}$ é o somatório do tempo em que o equipamento opera efetivamente na função primária. Os dados são extraídos via telemetria ou sistemas de gerenciamento de frota.

### RO — Rendimento Operacional (Operational Output)

Mede o rendimento operacional global do processo, representando a porcentagem de tempo do calendário em que o equipamento esteve em operação efetiva. É o indicador de síntese que reflete a integração entre a performance da manutenção e da operação, indicando a ocupação real do ativo frente ao tempo total disponível.

$$\mathrm{RO_{p}} = \mathrm{DF}_{p} \times \mathrm{UF}_{p} = \frac{HT_{p}}{HC_{p}} \times 100$$ {#eq-ro}

### PR — Produtividade (Productivity)

Mede o ritmo e a intensidade do processo durante o tempo operado ($\sum HT$). Ela desconsidera paradas de manutenção ou ociosidade.

$$\mathrm{PR_{p}} = \frac{\sum \text{Unidades de Produção}}{HT_{p}}$$ ::: {#exm-metrologia-aplicada .callout-note appearance="simple"}

::: {#exm-calculando-kpis}
#### **Metrologia Aplicada (Calculando KPIs)**

Para obter a os valores diários para os KPIs Disponibilidade (DF), Utilização (UF) e Produtividade (PR), executamos o cálculo das categorias de horas em métricas de performance ($WH$, $IH$, $MH$, $AH$). Cabe ressaltar que a produção das perfuratrizes é a soma dos metros perfurados (Meters Drilled) qem que $Meters Drilled =\sum \text{allocated_meters}$
:::

```{r}
#| label: tbl-kpi-final
#| echo: true
#| message: false

# Cruzamento de dados: Unindo categorias de horas com volume de produção
kpi_final <- resumo_gerencial %>%
  left_join(
    drill_events_mine_d %>%
      group_by(day = as_date(first_time), drill_id) %>%
      filter(drill_id == "DRILL_100", day >= "2023-01-01") %>%
      summarise(Production = sum(allocated_meters, na.rm = TRUE), .groups = "drop"),
    by = c("day", "drill_id")
  ) %>%
  mutate(
    # Nota ao leitor: Inclusão de categorias com valor zero para manter a estrutura do SGI
    WH = EFH + ODH + DWH + IWH,              # Worked Hours (Horas Trabalhadas)
    MH = CMH + ACH + SPH + NSPH,             # Maintenance Hours (Horas em Manutenção)
    AH = CH - MH,                            # Available Hours (Horas Disponíveis)
    PA = (AH / CH) * 100,                    # Disponibilidade Física (PA %)
    PU = (WH / AH) * 100,                    # Utilização Física (PU %)
    RO = (WH / CH) * 100,                    # Rendimento Operacional (RO %)
    PR = ifelse(WH == 0, 0, Production / WH) # Produtividade (PR)
  )

# Gerando a visão executiva através da exclusão das categorias de base
kpi_executivo <- kpi_final %>%
    slice_head(n = 10) %>%
  select(-c("EFH", "ODH", "IWH", "DWH", "IIH", "EIH", "CMH", "ACH", "SPH", "NSPH", "CH"))

# Renderização da tabela com nomes padronizados e estilo institucional
kpi_executivo %>%
  kable(
    digits = 2,
    align = "c",
    col.names = c("Data (p)", "Equipamento (TAG)", "Produção (m)",
                  "WH (h)", "MH (h)", "AH (h)", "DF (%)", "UF (%)", "RO (%)", "PR (m/h)")
  ) %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = TRUE, font_size = 12) %>%
  # Cabeçalho Teal Palette
  row_spec(0, background = "#35978f", color = "white", bold = TRUE) %>%
  # Destaque nas colunas de indicadores finais
  column_spec(7:10, bold = TRUE, background = "#e0f2f1", color = "#01665e") %>%
  # Linha final de 1.5pt para encerramento do bloco
  row_spec(nrow(kpi_executivo), extra_css = "border-bottom: 1.5pt solid black;")
```

##### Análise da Disponibilidade e Utilização (PA e PU)

Observa-se uma desconexão frequente entre a **Disponibilidade Física (PA)** e a **Utilização Física (PU)**. No dia 03/01, a manutenção entregou uma disponibilidade de **99,0%** (apenas 0,236h de intervenção), porém a operação utilizou apenas **56,2%** dessa janela. O motivo reside nas **10,4h** de ociosidade interna (IIH), evidenciando que o ativo estava pronto, mas a gestão de mina não possuía recursos ou frente para operá-lo.

O cenário torna-se crítico entre os dias 05/01 e 08/01. No dia 08/01, temos uma PA de **100%** com uma PU de **0%**. O registro de **24,0h** de IIH indica que o equipamento permaneceu totalmente ocioso por razões internas, resultando em produção zero, apesar de o ativo estar em perfeitas condições mecânicas.

##### Comportamento do Rendimento Operacional (RO)

O **RO** atua como o indicador de síntese da saúde do processo. No dia 01/01, o rendimento atingiu **60,8%**, o que representa uma integração saudável entre manutenção e operação. Em contrapartida, no dia 04/01, embora a disponibilidade fosse alta (**95,9%**), o rendimento despencou para **17,7%**.

Esta queda drástica no RO não foi causada por falhas no equipamento, mas sim por uma ineficiência na utilização. Como o RO é o produto da PA pela PU, ele expõe imediatamente o impacto de qualquer gargalo, seja ele mecânico ou gerencial, sobre o tempo total do calendário.

##### Variabilidade da Produtividade (PR)

A **Produtividade (PR)** mostra oscilações significativas que independem do tempo disponível. No dia 04/01, apesar de ter trabalhado poucas horas (WH = 4,25h), o ativo obteve sua maior produtividade unitária: **28,4 m/h**. Isso sugere que, durante o curto período em que operou, a taxa de penetração foi alta ou as condições da rocha eram favoráveis.

Já no dia 09/01, a produtividade caiu para **13,1 m/h**. Comparando com o dia 01/01 (onde a PR foi de **25,9 m/h**), o gestor deve investigar se a queda de quase 50% no ritmo de perfuração decorre de uma mudança na dureza da litologia ou de ineficiências operacionais não capturadas pelas siglas de atraso (ODH).

> **Resumo para o Leitor:** A série histórica revela que a **DRILL_100** sofre mais com perdas de utilização do que com indisponibilidade técnica. O baixo rendimento operacional (**RO**) na metade do período é reflexo direto de ociosidade interna (IIH), indicando que os esforços de melhoria devem ser focados no planejamento de lavra e alocação de operadores, e não apenas na redução de tempos de manutenção.

::: {#exm-evolucao_temporal}
#### Evolução Temporal da Produção

A visualização abaixo consolida o desempenho da perfuratriz ao longo de quase um ano de operação, permitindo ao gestor correlacionar as variações de metragem com os KPIs de disponibilidade e utilização discutidos anteriormente.
:::

```{r}
#| label: fig-evolucao-producao
#| fig-cap: "Evolução temporal da produção diária (metros perfurados)"
#| fig-width: 10
#| fig-height: 5

kpi_final %>%
  ggplot(aes(x = day, y = Production)) +
  # Linha principal com transparência para destacar os pontos
  geom_line(color = "#35978f", linewidth = 1, alpha = 0.6) +
  # Pontos para marcar as medições diárias discretas
  geom_point(color = "#01665e", size = 2, alpha = 0.8) +
  # Estética e Labels
  labs(
    x = "Data (p)",
    y = "Produção Acumulada (m)",
    title = "Série Histórica de Perfuração - DRILL_100"
  ) +
  theme_minimal() +
  scale_x_date(date_breaks = "1 month", date_labels = "%b/%y") +
  theme(
    plot.title = element_text(face = "bold", color = "#373854"),
    panel.grid.minor = element_blank()
  )
```

##### Fase 1: Estabilidade e Picos de Performance (Janeiro a Março)

Neste primeiro trimestre, o ativo apresentou sua melhor performance, embora com alta volatilidade. É possível observar ciclos de produção consistentes, com destaque para o dia **23/02**, onde a perfuratriz atingiu seu pico histórico de **562,3 metros**.

Entretanto, mesmo nesta fase "produtiva", a variabilidade é alta. Dias de alta performance são intercalados com paradas súbitas de 4 a 10 dias (como em meados de março), sugerindo que a operação trabalhava em regime de "campanha" ou sofria com interrupções frequentes de infraestrutura.

##### Fase 2: Degradação e Intermitência (Abril a Julho)

A partir de abril, o cenário muda drasticamente. A produção torna-se esparsa. O ativo passa a apresentar mais dias com **produção zero** do que dias operando. As janelas de atividade (como no início de maio e final de junho) são curtas e não sustentam o ritmo anterior.

Metrologicamente, isso indica que a **Utilização Física (UF)** desmoronou. O ativo ainda constava no inventário (gerando custo de capital e possivelmente de manutenção preventiva), mas não convertia tempo em metros perfurados.

##### Fase 3: Parada Crítica e Inatividade Prolongada (Agosto a Dezembro)

O dado mais impactante da série é a **inatividade total a partir de meados de julho**. Dos 340 dias analisados, quase a metade final do ano (aproximadamente 150 dias consecutivos) registra produção zero.

Para o gestor de ativos, este padrão levanta três hipóteses críticas que devem ser validadas na telemetria de categorias de horas (HO/HM):

1.  **Descomissionamento ou Falha Catastrófica:** O equipamento sofreu uma quebra que não justificou o reparo.

2.  **Mudança no Plano de Lavra:** A frente de serviço onde a perfuratriz atuava foi encerrada e o ativo não foi realocado.

3.  **Reserva Estratégica Ineficiente:** O ativo foi mantido como "back-up", mas nunca acionado, gerando um custo de oportunidade altíssimo.

##### Reconciliação com a Metrologia de Performance

Ao cruzarmos estes dados com o conceito de **Rendimento Operacional (RO)**, vemos que o indicador médio do ano será extremamente baixo. Um ativo que permanece 50% do ano parado resulta em um RO que inviabiliza o retorno sobre o investimento (ROI).

> **Resumo para o Leitor:** A série histórica da **DRILL_100** é o retrato de um ativo que "morreu" operacionalmente no meio do ano. Enquanto o primeiro trimestre mostrou que o equipamento tinha capacidade técnica (atingindo \>500m/dia), a inatividade prolongada no segundo semestre sugere uma falha grave de planejamento ou gestão de ativos. Em uma operação de excelência, este equipamento deveria ter sido transferido para outra unidade ou alienado para evitar a depreciação improdutiva.

::: {#exm-dados-budget}
#### **Base de Planejamento Estratégico (Budget)**

A transição da Metrologia de Performance para a Excelência Operacional exige um referencial comparativo. No sistema de gestão, este referencial é extraído do **Budget** (Orçamento Anual), que define as premissas de capacidade e as metas de entrega para cada ativo.

O banco de dados `drill_planning_mine_d` representa o "Planejamento da Qualidade" dentro da Trilogia de Juran. Ele consolida as metas de engenharia que devem ser perseguidas pela operação e manutenção.
:::

```{r}
#| label: tbl-planejamento-estrategico
#| echo: true

# Visualização das premissas de planejamento para a DRILL_100
drill_planning_mine_d %>%
  filter(drill_id == "DRILL_100", date >= "2023-01-01") %>%
  slice_head(n = 10) %>%
  kable(
    digits = 3,
    align = "c",
    col.names = c("Data (p)", "Equipamento (TAG)", "Modelo", "Método",
                  "HC Plan (h)", "HM Plan (h)", "HT Plan (h)",
                  "Meta DF", "Meta UF", "Meta PR (m/h)")
  ) %>%
  kable_styling(bootstrap_options = c("striped", "condensed"), full_width = TRUE, font_size = 11) %>%
  # Cabeçalho Teal Palette
  row_spec(0, background = "#35978f", color = "white", bold = TRUE) %>%
  # Destaque nos alvos (Targets) de performance
  column_spec(8:10, bold = TRUE, background = "#fcf8e3", color = "#8a6d3b") %>%
  # Linha final de 1.5pt para encerramento do bloco
  row_spec(10, extra_css = "border-bottom: 1.5pt solid black;")
```

#### Estrutura e Premissas do Planejamento

Os dados de planejamento diferem da telemetria por serem projeções estáticas de capacidade. Abaixo, detalhamos as variáveis fundamentais para o leitor:

-   **Horas Planejadas (HC, HM, HT):** Definem a distribuição teórica do tempo. Note que o `planned_maint_h` reflete o tempo que a engenharia de manutenção reservou para paradas preventivas e corretivas estimadas.

-   **Metas de Disponibilidade e Utilização:** Expressas em valores decimais (0 a 1), representam o compromisso de entrega técnica (**Meta DF**) e o desafio de ocupação operacional (**Meta UF**).

-   **Meta de Produtividade:** O valor de **21.4 m/h** é a linha de corte para a eficiência. Qualquer valor real abaixo desta meta sinaliza uma perda de ritmo que impactará o cumprimento do plano de lavra.

> **Nota para o Leitor:** Enquanto a telemetria nos diz o que "é", o `drill_planning_mine_d` nos diz o que "deveria ser". É através do cruzamento destas duas fontes que calcularemos, a seguir, os indicadores de desvio e impacto na produção.

## Planejamento vs. Realizado e o Production Gap

A integração entre o plano de lavra e a execução é realizada através do cruzamento das métricas de performance com os alvos (*targets*). O banco de dados `drill_planning_mine_d` fornece a referência necessária para calcularmos o desvio de aderência.

### EP — Eficiência de Produtividade (Productivity Efficiency — PE)

A **Eficiência de Produtividade** é o indicador que mensura a aderência do ritmo real de perfuração em relação à meta técnica estabelecida no planejamento (*Budget*). Ela reflete a qualidade da execução técnica, isolando a performance do ativo durante o tempo em que ele esteve efetivamente operando.

$$\mathrm{EP}_p = \left( \frac{\mathrm{PR}_{real}}{\mathrm{PR}_{plan}} \right) \times 100$$

{#eq-ep}

Onde a **PR** (Produtividade) é expressa em metros por hora ($m/h$) ou toneladas por hora ($t/h$). Uma **EP** de 100% indica que o processo operou exatamente no ritmo previsto pela engenharia.

### IP — Indicadores de Impacto na Produção (Production Impact Indicators — PII)

Os indicadores de impacto são ferramentas de diagnóstico da **Excelência Operacional**. Eles permitem converter desvios de tempo e ritmo em volume físico de produção (quilotoneladas — **Kt** ou metros). A grande vantagem desta metodologia é a capacidade de "dar nome aos bois": se a meta de produção não foi atingida, o **IP** dirá exatamente quanto dessa perda é responsabilidade da manutenção, da operação ou do processo.

#### $\Delta DF$ — Impacto de Disponibilidade Física (Physical Availability Impact — $\Delta PA$)

Este indicador mensura o impacto na produção relacionado à variação da disponibilidade física real em relação à programada. Ele isola a performance da manutenção, quantificando o volume de produção ganho ou perdido devido ao tempo em que o equipamento ficou parado para intervenções (corretivas ou preventivas).

$$\Delta DF = (HM_{plan} - HM_{real}) \times PR_{plan}$$

{#eq-ip-df}

-   **HM Plan:** Total de horas de manutenção programadas.

-   **HM Real:** Total de horas de manutenção efetivamente realizadas.

-   **PR Plan:** Taxa efetiva programada (m/h ou t/h).

Um resultado positivo indica que a manutenção entregou o ativo com maior disponibilidade que o previsto, gerando um ganho de oportunidade para a produção.

#### $\Delta UF$ — Impacto de Utilização Física (Physical Use Impact — $\Delta PU$)

O **IP-UF** mensura o impacto gerado pela variação na utilização do ativo. Ele foca na eficiência da gestão operacional em ocupar as janelas de tempo em que o equipamento estava disponível. Perdas aqui são geralmente causadas por falta de operador, infraestrutura deficiente ou falhas no sequenciamento de lavra.

$$\Delta PU = (UF_{real} - UF_{plan}) \times HD_{plan} \times PR_{plan}$$

{#eq-ip-uf}

-   **UF Real/Plan:** Percentual de utilização física (realizado vs. programado).

-   **HD Plan:** Horas disponíveis programadas para o período.

#### $\Delta PR$ — Impacto de Produtividade (Productivity Impact — $\Delta PR$)

O impacto de produtividade quantifica o ganho ou perda decorrente da intensidade do ritmo de operação. Diferente dos impactos de tempo (DF e UF), este foca na performance intrínseca do processo e é calculado de forma residual para garantir que a soma de todos os impactos seja igual ao desvio total de produção.

$$\Delta PR = Prod_{real} - \Delta PA - \Delta PU - Prod_{plan}$$

{#eq-ip-pr}

-   **Prod Real/Plan:** Volume total de produção (Realizado vs. Programado) no período.

::: {#exm-decomposicao-impactos}
### **Decomposição dos Impactos (Production Gap)**

A integração entre o plano de lavra (Budget) e a execução (Metrologia) é realizada através da análise de desvios. O objetivo é converter variações de tempo e ritmo em metros lineares, isolando as responsabilidades de cada área.

#### **Cálculo dos Indicadores de Impacto**

Neste estágio, unificamos o realizado (`kpi_final`) com o planejado (`drill_planning_mine_d`) para extrair os indicadores de impacto ($\Delta$).
:::

```{r}
#| label: tbl-kpi-impacto-final
#| echo: true

# Cruzamento dos dados Metrológicos com o Planejamento Estratégico
kpi_impacto <- kpi_final %>%
  left_join(drill_planning_mine_d %>% rename(day = date), by = c("day", "drill_id")) %>%
  mutate(
    # 1. Metas de Produção em Metros (m)
    # HC_plan * DF_meta * UF_meta * PR_meta
    Prod_plan_m = planned_calendar_h * target_availability * target_utilization * target_productivity,
    Prod_real_m = Production,

    # 2. Eficiência de Produtividade (%)
    EP = (PR / target_productivity) * 100,

    # 3. Impacto Disponibilidade (PI-PA) em metros
    # Diferença de horas de manutenção multiplicada pelo ritmo planejado
    PI_PA = (planned_maint_h - MH) * target_productivity,

    # 4. Impacto Utilização (PI-PU) em metros
    HD_plan = planned_calendar_h * target_availability,
    PI_PU = ((PU/100 - target_utilization) * HD_plan * target_productivity),

    # 5. Impacto Produtividade (PI-PR) em metros
    # Diferença residual que valida a identidade do gap
    PI_PR = Prod_real_m - PI_PA - PI_PU - Prod_plan_m
  )

# Renderização com a identidade visual Mining Analytics
kpi_impacto %>%
  select(day, drill_id, Prod_plan_m, Prod_real_m, EP, PI_PA, PI_PU, PI_PR) %>%
  slice_head(n = 10) %>%
  kable(
    digits = 1,
    align = "c",
    col.names = c("Data", "TAG", "Plano (m)", "Real (m)", "EP (%)", "Δ PA (m)", "Δ PU (m)", "Δ PR (m)")
  ) %>%
  kable_styling(bootstrap_options = c("striped", "condensed"), full_width = TRUE, font_size = 11) %>%
  row_spec(0, background = "#35978f", color = "white", bold = TRUE) %>%
  add_header_above(
    c(" " = 2, "Performance Base" = 3, "Decomposição de Impactos (Production Gap)" = 3),
    background = "#35978f", color = "white", bold = TRUE,
    extra_css = "border-bottom: 2px solid #d4af37;"
  ) %>%
  column_spec(3:4, bold = TRUE) %>%
  column_spec(6:8, background = "#fcf8e3", color = "#8a6d3b", bold = TRUE) %>%
  row_spec(10, extra_css = "border-bottom: 1.5pt solid black;")
```

#### **Interpretação e Gestão de Desvios**

A tabela de impactos permite uma leitura direta da "saúde" operacional da **DRILL_100**:

-   **Δ PA (Manutenção):** Se negativo, indica que a manutenção "roubou" metros da produção por exceder o tempo de parada planejado. Se positivo (como pode ocorrer em dias de alta disponibilidade), a manutenção entregou um ganho de oportunidade.

-   **Δ PU (Operação):** Quantifica os metros perdidos por ociosidade. É o reflexo direto das horas de atraso operacional (ODH) e ociosidade interna (IIH) discutidas na fase de metrologia.

-   **Δ PR (Processo/Engenharia):** Isola a performance da perfuração em si. Se negativo, a máquina perfurou mais devagar que a meta de **21.4 m/h**, possivelmente por dureza da rocha ou falha técnica no bit.

#### **Nota Técnica: Identidade da Reconciliação**

Para garantir a integridade dos dados no sistema de gestão, o somatório dos impactos deve reconciliar exatamente o desvio total observado. Matematicamente, para cada intervalo $p$:

$$(Prod_{Real} - Prod_{Plan})_p = \Delta PI_{PA} + \Delta PI_{PU} + \Delta PI_{PR}$$

Esta identidade assegura que não existam "metros fantasmas" na análise. Todo metro não perfurado tem um dono e uma causa raiz identificável, eliminando a subjetividade nas reuniões de resultados.

### **Representação Visual do Production Gap**

Abaixo, consolidamos a decomposição de impactos em um gráfico de cascata (*Waterfall*). Note o uso da simbologia técnica ($\Delta$) para identificar os desvios de Disponibilidade, Utilização e Produtividade.

```{r}
#| label: fig-waterfall-final
#| fig-cap: "Decomposição do Gap de Perfuração - Metrologia vs. Planejamento"
#| fig-width: 10
#| fig-height: 6

# 1. Preparação dos Dados Sumarizados
df_plot <- kpi_impacto %>%
  summarise(
    Planejado = sum(Prod_plan_m, na.rm = TRUE),
    Delta_PA  = sum(PI_PA, na.rm = TRUE),
    Delta_PU  = sum(PI_PU, na.rm = TRUE),
    Delta_PR  = sum(PI_PR, na.rm = TRUE),
    Realizado = sum(Prod_real_m, na.rm = TRUE)
  ) %>%
  pivot_longer(everything(), names_to = "Categoria", values_to = "Valor") %>%
  mutate(
    Categoria = factor(Categoria, levels = c("Planejado", "Delta_PA", "Delta_PU", "Delta_PR", "Realizado")),
    tipo = ifelse(Categoria %in% c("Planejado", "Realizado"), "Total", "Impacto"),
    # Cálculo das coordenadas das barras
    fim = cumsum(Valor),
    inicio = lag(fim, default = 0)
  )

# Ajuste para a barra de 'Realizado' começar do zero (barra de fechamento)
df_plot$inicio[df_plot$Categoria == "Realizado"] <- 0
df_plot$fim[df_plot$Categoria == "Realizado"] <- df_plot$Valor[df_plot$Categoria == "Realizado"]

# 2. Construção do Gráfico com Símbolos Matemáticos
ggplot(df_plot, aes(x = Categoria, fill = tipo)) +
  geom_rect(aes(xmin = as.numeric(Categoria) - 0.35,
                xmax = as.numeric(Categoria) + 0.35,
                ymin = inicio, ymax = fim),
            color = "black", alpha = 0.85) +
  # Rótulos de valores sempre no topo (ymax) para manter a altura consistente
  geom_text(aes(y = fim, label = round(Valor, 1)),
            vjust = -0.6, fontface = "bold", size = 3.5) +
  # Configuração de Cores Institucionais
  scale_fill_manual(values = c("Total" = "#35978f", "Impacto" = "#d4af37")) +
  # Tradução dos nomes dos eixos com símbolos Delta e Subscritos
  scale_x_discrete(labels = c(
    "Planejado",
    expression(Delta[PA]),
    expression(Delta[PU]),
    expression(Delta[PR]),
    "Realizado"
  )) +
  labs(
    title = expression(bold("Waterfall: Decomposição do Production Gap (m)")),
    subtitle = "Ativo: DRILL_100 | Análise de Aderência ao Planejamento",
    x = "Indicadores de Performance",
    y = "Metros Perfurados (m)"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    axis.text.x = element_text(size = 11, color = "#373854"),
    plot.title = element_text(size = 14, color = "#373854"),
    panel.grid.minor = element_blank()
  )
```

#### **Interpretação da Visualização**

Nesta representação, o leitor consegue identificar visualmente a "escada" de performance:

-   **As colunas de fechamento (Planejado e Realizado):** Estão na cor **Teal (#35978f)**, representando os volumes absolutos de metros.

-   **As colunas de desvio (**$\Delta$): Estão na cor **Dourada (#d4af37)**. Quando a barra dourada está abaixo do nível da anterior, ela representa um "degrau negativo", indicando que aquele KPI específico reduziu a entrega final.

-   **Simetria de Rótulos:** Note que os valores estão todos posicionados no topo das barras (`ymax`), garantindo que o gestor visualize o número final de metros perfurados ou perdidos de forma clara, sem obstrução pelo corpo da barra.

#### **Nota Técnica sobre ROP e Metrologia**

Observe que o $\Delta_{PR}$ (Produtividade) isola a variabilidade da rocha e do operador. Se a barra do $\Delta_{PR}$ for a maior queda no gráfico, o problema não é o tempo disponível, mas sim a **taxa de penetração (ROP)**, exigindo uma revisão nos parâmetros de perfuração ou na seleção dos acessórios de corte (bits).

### **OEE – Eficiência Global do Equipamento (*Overall Equipment Effectiveness*)**

O indicador **OEE – Eficiência Global do Equipamento (*Overall Equipment Effectiveness*)**, baseia-se no índice de performance múltiplo de indicadores, aliando os processos de manutenção e produção. Ele serve não apenas como um medidor de falhas, mas como um ponto focal de melhorias sucessivas (AMORIM, 2009).

Sua origem remonta ao Japão, oriundo da **TPM – Gestão Produtiva Total (*Total Productive Maintenance*)**. Nakajima (1989), idealizador da filosofia supracitada, definiu que a gestão produtiva total busca a manutenção participativa, com o intuito de se obter máquinas sempre aptas, sem quebras, falhas e defeito mínimo.

Nesse contexto, este indicador visa aumentar a confiabilidade dos equipamentos, sendo um parâmetro efetivo para medição da eficácia das máquinas, assim como para a gestão da produtividade (PALOMINO, 2010). A OEE das perfuratrizes é calculada pela multiplicação de três ICDs: **PA – Disponibilidade Física (*Physical Availability*)**, **PU – Utilização Física (*Physical Use*)** e **EP – Eficiência de Produtividade (*Productivity Efficiency*)**, de acordo com a Equação (6).

$$OEE = PA \times PU \times \left( \frac{PR_{real}}{PR_{plan}} \right)$$

### **Cálculo e Implementação do OEE**

No processamento abaixo, consolidamos o OEE da **DRILL_100**. Note que o cálculo utiliza os resultados obtidos na metrologia e na análise de impacto anteriores.

```{r}
#| label: tbl-oee-final
#| echo: true

# Cálculo do OEE baseado nos indicadores calculados anteriormente
kpi_oee <- kpi_impacto %>%
  mutate(
    # Convertendo percentuais para decimais para o cálculo do OEE
    # OEE = (PA/100) * (PU/100) * (EP/100)
    OEE = (PA / 100) * (PU / 100) * (EP / 100) * 100
  )

# Renderização da Tabela de Eficiência Global
kpi_oee %>%
  select(day, drill_id, PA, PU, EP, OEE) %>%
  slice_head(n = 10) %>%
  kable(
    digits = 1,
    align = "c",
    col.names = c("Data", "TAG", "DF/PA (%)", "UF/PU (%)", "EP (%)", "OEE (%)")
  ) %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = TRUE, font_size = 11) %>%
  row_spec(0, background = "#35978f", color = "white", bold = TRUE) %>%
  # Destaque para a coluna OEE (Borda Dourada de Resultado)
  column_spec(6, bold = TRUE, background = "#fcf8e3", color = "#8a6d3b", border_left = "1px solid #d4af37") %>%
  row_spec(10, extra_css = "border-bottom: 1.5pt solid black;")
```

### **Nota Técnica: A Matemática da Eficiência**

Para fins de padronização no SGI (Sistema de Gestão Integrado), a fórmula do OEE no R deve sempre garantir que os inputs de $PA$ e $PU$ reflitam a realidade metrológica processada anteriormente:

$$OEE = \left( \frac{AH}{CH} \right) \times \left( \frac{WH}{AH} \right) \times \left( \frac{PR_{real}}{PR_{plan}} \right)$$

Simplificando a equação, percebe-se que o OEE é, em última análise, o **Rendimento Operacional (RO)** ajustado pela eficiência de ritmo:

$$OEE = RO \times EP$$

> **Insight para o Leitor:** Enquanto o RO nos diz quanto tempo o calendário foi aproveitado, o OEE nos diz quão bem esse tempo foi convertido em metros perfurados em relação à meta de engenharia.

### **Árvore de Perdas e Hierarquia do OEE**

Para que o **OEE** deixe de ser apenas um número e se torne uma ferramenta de diagnóstico, é necessário decompor seus três pilares em indicadores de causa raiz. A hierarquia abaixo detalha como a performance da **DRILL_100** é influenciada por fatores de manutenção, operação e geologia.

#### **1. Pilar de DF – Disponibilidade Física (*Physical Availability*)**

A disponibilidade é governada pelas **HM – Horas de Manutenção (*Maintenance Hours*)**. Para otimizar este pilar, analisamos:

-   **MTTR – Tempo Médio para Reparo (*Mean Time to Repair*):** Mede a eficiência da equipe de manutenção em solucionar falhas ($HMC / \text{quantidade de falhas}$).

-   **MTBF – Tempo Médio Entre Falhas (*Mean Time Between Failures*):** Mede a confiabilidade do ativo ($AH / \text{número de falhas}$).

#### **2. Pilar de UF – Utilização Física (*Physical Use*)**

A utilização é impactada diretamente pelas **HI – Horas Improdutivas (*Unproductive Hours*)**. Este pilar reflete a gestão da frota e a eficiência operacional na mina, sendo influenciado por esperas de infraestrutura, trocas de turno e posicionamento.

#### **3. Pilar de Prod – Produtividade (*Productivity*)**

A produtividade (m/h) na perfuração não depende apenas do equipamento, mas do meio em que ele atua:

-   **Litologia:** Setorização da mina por domínios litológicos (dureza da rocha).

-   **Tecnologia (Autodrill):** Comparativo de performance entre perfuratrizes com e sem sistema de perfuração automatizada.

-   **HT – Horas Trabalhadas (*Worked Hours*):** Foco na redução de horas trabalhadas não efetivas para maximizar a taxa de penetração.

### **Implementação dos Indicadores de Confiabilidade no R**

Para complementar a análise da **DRILL_100**, podemos calcular os drivers de manutenção (**MTTR** e **MTBF**) que alimentam o pilar de disponibilidade da nossa árvore:

```{r}
#| label: tbl-confiabilidade
#| echo: true

# Cálculo de Confiabilidade e Manutenibilidade
# Simulação de número de falhas baseado em threshold de CMH
kpi_confiabilidade <- kpi_final %>%
  mutate(
    # Estimativa de falhas: considera uma falha quando CMH > 1 hora
    n_falhas = ifelse(CMH > 1, 1, 0),

    # MTBF = Horas Disponíveis / Número de Falhas
    MTBF = ifelse(n_falhas == 0, AH, AH / n_falhas),

    # MTTR = Horas de Manutenção Corretiva / Número de Falhas
    MTTR = ifelse(n_falhas == 0, 0, CMH / n_falhas)
  )

# Exibição dos drivers da DF (Disponibilidade)
kpi_confiabilidade %>%
  select(day, drill_id, PA, MTBF, MTTR) %>%
  slice_head(n = 10) %>%
  kable(
    digits = 2,
    align = "c",
    col.names = c("Data", "TAG", "PA (%)", "MTBF (h)", "MTTR (h)")
  ) %>%
  kable_styling(bootstrap_options = c("striped", "condensed"), full_width = TRUE) %>%
  row_spec(0, background = "#35978f", color = "white", bold = TRUE)
```

### **Nota Técnica: O Fluxo de Diagnóstico**

No modelo de excelência apresentado, o fluxo de análise deve seguir a hierarquia de cima para baixo:

1.  O **OEE** sinaliza que a eficiência global caiu.

2.  O gestor identifica qual pilar (**PA, PU** ou **EP**) causou a queda.

3.  Se a causa foi a **PA**, verifica-se o **MTBF** (o equipamento quebrou muito?) ou o **MTTR** (a manutenção demorou a consertar?).

4.  Se a causa foi a **Produtividade**, verifica-se se a perfuratriz entrou em uma **Litologia** mais dura ou se o sistema **Autodrill** estava desabilitado.

> **Insight de Gestão:** A árvore de indicadores transforma dados brutos em planos de ação. Se o MTTR está alto, o foco é treinamento e logística de peças; se o MTBF está baixo, o foco é a qualidade da manutenção preventiva.

## Advanced Maintenance Performance and Impact Analysis

### Medidas de Performance da Manutenção

Após um determinado tempo $t$, os dados são organizados em eventos de operação ($HT$) ou de manutenção ($HM$), desconsiderando as horas ociosas ($HO$) para o gráfico de processo de contagem. As falhas ocorrem em $t_1, t_2, \dots$ e as manutenções sistemáticas em $\tau_1, \tau_2, \dots$, gerando funções-escada.

#### Mean Time Between Failures (MTBF)

Representam as horas trabalhadas ($HT$), onde $HT = \sum_{i=1}^{NIC} TBF_i$.

$$\mathrm{MTBF} = \frac{HT}{NIC}$$ {#eq-mtbf}

#### Mean Time To Repair (MTTR)

Tempo médio para reparo das intervenções corretivas e acidentes ($HTMC = \sum TTR_i$).

$$\mathrm{MTTR} = \frac{HTMC}{NIC}$$

#### Mean Time Between Systematics (MTBS)

Tempo médio entre manutenções sistemáticas considerando as horas trabalhadas.

$$\mathrm{MTBS} = \frac{HT}{NIS}$$

#### Mean Time To Maintain (MTTM)

Tempo médio gasto para manutenir um equipamento em intervenções preventivas ($MPS = \sum TTM_j$).

$$\mathrm{MTTM} = \frac{MPS}{NIS}$$

### Mensuração de Impacto na Incidência de Corretivas

#### ISI – Incidência de Intervenções Sistemáticas (Systematic Intervention Incidence)

$$\mathrm{ISI} = \frac{NIS}{k} \quad \text{onde } k \text{ é o número de intervenções programadas.}$$

#### ATSP – Aderência à Periodicidade Sistemática (Systematic Periodicity Adherence)

$$\mathrm{ATSP} = \frac{\mathrm{MTBS}}{\bar{\chi}} \quad \text{onde } \bar{\chi} = \frac{1}{k} \sum_{j=1}^{k} \chi_j \text{ é a periodicidade média prevista.}$$

**Exemplo:** $ATSP = 1.5$ indica um atraso médio de 125h para início da execução ($\bar{\chi} = 250h$), resultando em $ISI < 1$.

#### ISAC – Impacto da Aderência Sistemática nas Corretivas (Impact of Systematic Adherence on Corrective)

Estima quantas falhas ocorrem devido ao desvio da periodicidade ótima ($\bar{\chi}$).

$$\mathrm{ISAC} = \frac{\mathrm{MTBS} - \bar{\chi}}{\mathrm{MTBF}} \times NIS$$

**Meta:** $ISAC \cong 0$. A não execução de uma pauta dobra o intervalo ($2\bar{\chi}$), aumentando as intervenções corretivas.

### Mensuração de Impacto na Disponibilidade

#### ATTM – Aderência ao Tempo de Manutenção (Maintenance Time Adherence)

$$\mathrm{ATTM} = \frac{SPH}{S} \quad \text{onde } S \text{ é o tempo previsto para as pautas.}$$

#### FMS – Fator de Manutenção Sistemática (Systematic Maintenance Factor)

$$\mathrm{FMS} = \frac{\mathrm{MTTM}}{(\mathrm{ATTM} - 1) \times HM}$$

#### IPA / IDF – Impacto na Disponibilidade Física (Impact on Physical Availability)

Consolida o aumento de reparos e a ineficiência da execução:

$$\mathrm{IPA} = \frac{(\mathrm{ISAC} \times \mathrm{MTTR}) + (\mathrm{FMS} \times HM)}{HC}$$

### Refinamentos de Disponibilidade Técnica

#### Disponibilidade Intrínseca (DI) / (Inherent Availability)

Foca no desempenho inerente via inter-relação entre confiabilidade e mantenabilidade.

$$\mathrm{DI} = \left[ \frac{\mathrm{MTBF}}{\mathrm{MTBF} + \mathrm{MTTR}} \right] \times 100 \quad \text{ou} \quad \mathrm{DI} = \left[ \frac{\sum HT}{\sum (HT + HMC)} \right] \times 100$$

#### Disponibilidade Operacional (DO) / (Operational Availability)

Avalia o tempo em que o equipamento estava apto durante as janelas de exigência real.

$$\mathrm{DO} = \left[ \frac{\sum (\text{Horas Operacionais} - \text{Horas Manutenção})}{\sum \text{Horas Operacionais}} \right] \times 100$$

## Indicadores de Gestão da Manutenção (PCM)

### Aderências aos Planos e Programação

**AMS – Aderência à Manutenção Sistemática (Systematic Maintenance Adherence):** Cumprimento dentro da tolerância ($\pm 10\%$).

**AMC – Aderência à Manutenção Condicional (Conditional Maintenance Adherence):** Resposta a alertas preditivos (janela de -30 a +5 dias).

**APM – Aderência ao Plano de Manutenção (Maintenance Plan Adherence):** Composição de AMS e AMC.

**APR – Aderência à Programação (Schedule Compliance):** Execução do planejado semanal (Baseline), excluindo ordens emergenciais (EXPROG).

### Gestão de Mão de Obra e Esforço

**IMOP – Índice de Utilização de Mão de Obra Programada (Scheduled Labor Utilization Index):** HH planejado programado executado / HH disponível.

**IAMO – Índice de Apropriação de Mão de Obra (Labor Appropriation Index):** Qualidade do registro de horas-homem nos centros de trabalho.

**RMS, RMC e IMC:** Relações de esforço percentual entre manutenções sistemáticas, corretivas e o índice de frequência de falhas.

### Backlog e Qualidade do Dado

**Backlog (Carteira Pendente):** Tempo em dias necessário para zerar a carteira de serviços pendentes.

$$\mathrm{Backlog} = \frac{\sum \text{HH Planejado} - \sum \text{HH Executado}}{\text{HH Disponível}}$$ {#eq-backlog}

**ACF – Apropriação de Classe de Falha (Failure Class Appropriation):** Percentual de ordens corretivas (YCM/YEM) com preenchimento completo dos 5 níveis de falha no SAP, vital para análises de causa raiz.

## Gestão de Fluxo de Trabalho e Portfólio (Workflow Management)

**TMOMS – Tempo Médio por Status (Average Maintenance Order Times by Status):** Mede o lead time (Planejamento, Aprovisionamento, Programação, Execução).

$$\text{TMOMS} = \frac{\sum (\text{Tempo da OM no status})}{\sum (\text{Quantidade de OMs no status})}$$

**IMNC – Idade Média de Notas Não Tratadas (Average Age of Untreated Notifications):** Tempo de notas sem vinculação à uma ordem de serviço.

**IMOS – Idade Média de Ordens Abertas (Average Age of Open Orders):** Idade média das ordens na carteira ativa.
